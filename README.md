# Optimal Order Allocation Backtester

This project implements a backtester for an optimal order allocation algorithm against various benchmark strategies.

## Overview

The backtester evaluates the performance of allocating orders across multiple venues with different pricing and liquidity characteristics. It optimizes based on three penalty parameters:

- `lambda_over`: Penalty for exceeding the target order size (ranges: 0.0, 0.05, 0.1, 0.2, 0.5)
- `lambda_under`: Penalty for falling short of the target order size (ranges: 0.0, 0.05, 0.1, 0.2, 0.5)
- `theta_queue`: Penalty for queue risk (ranges: 0.0, 0.05, 0.1, 0.2)

## File Structure

- `backtest.py` - Main implementation with the allocation algorithm and benchmark strategies
- `README.md` - Project documentation
- `results.png` - Visualization of performance comparison between strategies (generated by running plot_results.py)

## Benchmark Strategies

The algorithm is compared against three common strategies, as requested by the doc:
- **Best Ask**: Always execute at the venue with the lowest ask price
- **TWAP**: Time-Weighted Average Price with 60-second windows
- **VWAP**: Volume-Weighted Average Price, proportionally allocating based on available depth

## Slippage and Queue Modeling

The algorithm models queue dynamics and slippage through several mechanisms:

1. **Queue Placement Risk**: The `theta_queue` parameter penalizes order placement that might not execute, modeling the risk of positions in the order queue.

2. **Asymmetric Size Penalties**: Separate `lambda_over` and `lambda_under` parameters allow fine-tuning the cost trade-offs between overfilling and underfilling the order.

3. **Venue-Specific Fees**: Each venue has associated fee and rebate structures that affect the execution costs.

4. **Execution Probability**: The algorithm implicitly models execution probability by comparing allocated shares to available size at each venue.

Further improvements could include:
- Time-dependent execution probability functions
- Venue-specific queue position modeling
- Machine learning-based fill probability estimation

## Results

The backtest optimizes the parameters and reports:
- Optimal parameter values
- Average execution price for each strategy  
- Savings in basis points versus each benchmark strategy

## Usage

To run the backtest:
```
python backtest.py
```

The backtest script expects a CSV file named `l1_day.csv` with market data in the specified format.
